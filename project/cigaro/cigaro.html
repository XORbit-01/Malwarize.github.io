<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8" />





    <link rel="stylesheet" href="static/markdown.css">

    <title>
        Malwarize
    </title>
    <link rel="stylesheet" href="static/output.css">
    <style>
    </style>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.7.0/flowbite.min.js"></script>
</head>

<body class="text-xs  bg-gray-200 text-blacks dark:bg-graymain dark:text-white transition-all duration-[1000ms] md:text-xl">
    <header class="sticky top-0 z-50">
        <nav id="nav" class="md:flex justify-between p-5 text-black shadow items-center bg-white dark:bg-graylight dark:text-white transition-all duration-[1500ms] ">
            <!-- logo and donate -->
            <div class="flex space-x-2 justify-between items-center md:flex md:items-center">
                <!-- nav btn for mobile -->
                <button class="md:hidden" id="expand">
                <svg class="w-5 h-5 text-purplemain fill-purplemain" viewBox="0 0 52 52" data-name="Layer 1"
                    id="Layer_1" xmlns="http://www.w3.org/2000/svg">
                    <path d="M50,12.5H2a2,2,0,0,1,0-4H50a2,2,0,0,1,0,4Z" />
                    <path d="M50,28H2a2,2,0,0,1,0-4H50a2,2,0,0,1,0,4Z" />
                    <path d="M50,43.5H2a2,2,0,0,1,0-4H50a2,2,0,0,1,0,4Z" />
                </svg>
            </button>

                <!-- logo -->
                <a href="/">
                    <div class="flex mr-4 space-x-2 items-center">
                        <svg version="1.1" id="_x32_" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="w-10">
                        <style type="text/css">
                            .st0 {
                                fill: #5a08dd;
                            }
                        </style>
                        <g>
                            <path class="st0" d="M251.777,408.739l3.352-79.744h125.915l1.672,79.744h67.162L459.953,288.7H512
                            c0-120.882-63.802-141.029-88.981-141.029H249.632C219.419,56.135,171.157-2.201,102.315,9.545
                            c-24.064,4.112-46.604,16.059-59.984,35.339l-35.71,2.602c-2.671,0.201-5.002,1.866-6.047,4.328
                            c-1.053,2.462-0.635,5.304,1.076,7.355l27.186,32.698c0.364,0.45,0.79,0.828,1.239,1.162c0.31,3.941,0.874,8.014,1.742,12.211
                            c1.75,8.587,17.623,78.064,17.623,78.064h54.146c0,0,2.501-54.131,2.965-58.297c0.836-7.549,6.125-12.798,10.91,0l68.834,283.731
                            H251.777z" />
                            <rect x="148.904" y="418.339" class="st0" width="331.14" height="30.213" />
                            <path class="st0" d="M218.157,456.11c-13.209,0-23.926,10.708-23.926,23.918c0,13.217,10.716,23.926,23.926,23.926
                            c13.209,0,23.926-10.709,23.926-23.926C242.083,466.818,231.366,456.11,218.157,456.11z" />
                            <path class="st0" d="M419.612,456.11c-13.209,0-23.918,10.708-23.918,23.918c0,13.217,10.708,23.926,23.918,23.926
                            c13.209,0,23.925-10.709,23.925-23.926C443.537,466.818,432.821,456.11,419.612,456.11z" />
                        </g>
                    </svg>
                        <span class="font-bold">Malwarize</span>
                    </div>
                </a>
                <!-- coffe -->
                <a href="#" class="hidden md:btn mr-4">‚òï Donate</a>
            </div>
            <!-- links container -->
            <div class="md:flex md:items-center md:space-x-4 bg-neutral-200 rounded-lg dark:bg-neutral-700 px-4">
                <div class="hidden md:flex md:items-center md:space-x-4">
                    <a href="https://github.com/XORbit-01/" class="btn">üìÉ Github</a>
                    <a href="https://twitter.com/XORbit01" class="btn">üê¶ Twitter</a>
                    <a href="https://discord.gg/CXYzD3Zf6Y" class="btn">üí¨ Chat</a>
                    <a href="https://discord.gg/CXYzD3Zf6Y" class="btn">‚úâÔ∏è Contact</a>
                </div>
                <!-- night mode toggle -->
                <button id="theme-toggle" type="button" name="theme-toggle" class="float-right rounded-full bg-gray-300 border dark:bg-neutral-700 dark:border-purplemain border-purple-600 md:border-transparent md:rounded-lg md:dark:border-transparent md:dark:bg-transparent text-gray-500 md:bg-transparent hover:text-purplemain hover:bg-gray-200  dark:hover:bg-gray-700 dark:hover:text-purplemain transition-all duration-500 text-sm p-2">
                <svg id="theme-toggle-dark-icon" class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20"
                    xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"
                        fill-rule="evenodd" clip-rule="evenodd"></path>
                </svg>
                <svg id="theme-toggle-light-icon" class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
                </svg>
            </button>
            </div>


            <aside class="transition-all duration-700 opacity-0 -translate-x-full md:hidden absolute inset-y-0 left-0  bg-gray-200 w-72 shadow-lg shadow-purple-600 rounded-r-lg h-screen text-lg dark:bg-neutral-600 ease-in-out  " id="nav-mobile">
                <div class="flex flex-col pr-4 pl-3 space-y-5 pt-4">

                    <button class="flex justify-between" id="collapse">
            <span class="font-bold">Malwarize</span>
            <svg class="w-7 h-7 font-bold text-purplemain fill-purplemain" viewBox="0 0 32 32" id="icon"
                xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <style>
                        .cls-1 {
                            fill: none;
                        }
                    </style>
                </defs>
                <title>exit</title>
                <rect x="26" y="4" width="2" height="24" />
                <polygon
                    points="11.414 20.586 7.828 17 22 17 22 15 7.828 15 11.414 11.414 10 10 4 16 10 22 11.414 20.586" />
                <rect id="_Transparent_Rectangle_" data-name="&lt;Transparent Rectangle&gt;" />
            </svg>
        </button>

                    <ul class="spyscroll-list">
                        <li class='spyscroll-selected-item'>
                            <a href="#cigar" class="btn">
                                <p class="uppercase">Cigar</p>
                            </a>
                        </li>
                        <li>
                            <a href="#" class="btn">
                                <p class="uppercase">wrapper framework for any command line tool</p>
                            </a>
                        </li>
                        <li>
                            <a href="#installation" class="btn">
                                <p class="uppercase">Installation</p>
                            </a>
                        </li>
                        <li>
                            <a href="#how-to-use" class="btn">
                                <p class="uppercase">How to use</p>
                            </a>
                        </li>
                    </ul>
                    <div class="my-4"></div>
                    <a href="https://github.com/XORbit-01/" class="btn shadow-inner bg-neutral-500 rounded p-2 text-white">üìÉ
            Github</a>
                    <a href="https://twitter.com/XORbit01" class="btn shadow-inner bg-neutral-500 rounded p-2 text-white">üê¶
            Twitter</a>
                    <a href="https://discord.gg/CXYzD3Zf6Y" class="btn shadow-inner bg-neutral-500 rounded p-2 text-white">üí¨
            Chat</a>
                    <a href="https://discord.gg/CXYzD3Zf6Y" class="btn shadow-inner bg-neutral-500 rounded p-2 text-white">‚úâÔ∏è
            Contact</a>

                </div>
            </aside>

            <aside class="transition-all duration-700 opacity-0 -translate-x-full md:hidden absolute inset-y-0 left-0  bg-gray-200 w-72 shadow-lg shadow-purple-600 rounded-r-lg h-screen text-lg dark:bg-neutral-600 ease-in-out  " id="nav-mobile">
                <div class="flex flex-col pr-4 pl-3 space-y-5 pt-4">

                    <button class="flex justify-between" id="collapse">
            <span class="font-bold">Malwarize</span>
            <svg class="w-7 h-7 font-bold text-purplemain fill-purplemain" viewBox="0 0 32 32" id="icon"
                xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <style>
                        .cls-1 {
                            fill: none;
                        }
                    </style>
                </defs>
                <title>exit</title>
                <rect x="26" y="4" width="2" height="24" />
                <polygon
                    points="11.414 20.586 7.828 17 22 17 22 15 7.828 15 11.414 11.414 10 10 4 16 10 22 11.414 20.586" />
                <rect id="_Transparent_Rectangle_" data-name="&lt;Transparent Rectangle&gt;" />
            </svg>
        </button>

                    <ul class="spyscroll-list">
                        <li class='spyscroll-selected-item'>
                            <a href="#cigar" class="btn">
                                <p class="uppercase">Cigar</p>
                            </a>
                        </li>
                        <li>
                            <a href="#" class="btn">
                                <p class="uppercase">wrapper framework for any command line tool</p>
                            </a>
                        </li>
                        <li>
                            <a href="#installation" class="btn">
                                <p class="uppercase">Installation</p>
                            </a>
                        </li>
                        <li>
                            <a href="#how-to-use" class="btn">
                                <p class="uppercase">How to use</p>
                            </a>
                        </li>
                    </ul>
                    <div class="my-4"></div>
                    <a href="https://github.com/XORbit-01/" class="btn shadow-inner bg-neutral-500 rounded p-2 text-white">üìÉ
            Github</a>
                    <a href="https://twitter.com/XORbit01" class="btn shadow-inner bg-neutral-500 rounded p-2 text-white">üê¶
            Twitter</a>
                    <a href="https://discord.gg/CXYzD3Zf6Y" class="btn shadow-inner bg-neutral-500 rounded p-2 text-white">üí¨
            Chat</a>
                    <a href="https://discord.gg/CXYzD3Zf6Y" class="btn shadow-inner bg-neutral-500 rounded p-2 text-white">‚úâÔ∏è
            Contact</a>

                </div>
            </aside>
        </nav>
    </header>

    <!--collapse and expand -->
    <script>
        const collapse = document.getElementById('collapse');
        const navMobile = document.getElementById('nav-mobile');
        const expand = document.getElementById('expand');
        collapse.addEventListener('click', () => {
            navMobile.classList.replace("opacity-1", "opacity-0");
            navMobile.classList.replace("translate-x-0", "-translate-x-full");

        });
        expand.addEventListener('click', () => {
            navMobile.classList.replace("opacity-0", "opacity-1");
            navMobile.classList.replace("-translate-x-full", "translate-x-0");
        });
    </script>
    <a href="#" id="scrollToTopButton" class="fixed bottom-4 right-4 p-4 bg-purplemain text-white rounded-full shadow-md hidden z-50">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path>
        </svg>
    </a>


    <div class="md:grid md:grid-cols-4 md:m-10">
        <div class="hidden md:flex md:col-span-1">

            <ul class="spyscroll-list">
                <li class='spyscroll-selected-item'>
                    <a href="#cigar" class="btn">
                        <p class="uppercase">Cigar</p>
                    </a>
                </li>
                <li>
                    <a href="#" class="btn">
                        <p class="uppercase">wrapper framework for any command line tool</p>
                    </a>
                </li>
                <li>
                    <a href="#installation" class="btn">
                        <p class="uppercase">Installation</p>
                    </a>
                </li>
                <li>
                    <a href="#how-to-use" class="btn">
                        <p class="uppercase">How to use</p>
                    </a>
                </li>
            </ul>
        </div>
        <div class="my-4 mx-2 md:px-10 col-span-3 rounded  ">
            <div id="readmeContent" class="markdownl ">
                <h1 id="cigar">Cigar</h1>
                <p align=center>
                    <image src="cigaro.png" />
                </p>
                <h2 align=center>wrapper framework for any command line tool</h2>
                <h1 id="installation">Installation</h1>
                <pre><code class="language-bash">pip install cigaro
</code></pre>
                <h1 id="how-to-use">How to use</h1>
                <h3 id="1-create-tool-module-for-your-command-line-tool">1. Create Tool module for your command line tool</h3>
                <p>the tool module should have a class that inherits from <code>cigar.ToolAbstract</code></p>
                <pre><code class="language-python"># modules.py
# create a class that inherits from ToolAbstract
from cigaro.AbstractTool import ToolAbstract
class Hydra(ToolAbstract):
    def __init__(self, target: str, user: str, wordlist: str, protocol: str):
        path = &quot;/usr/bin/hydra&quot;
        super().__init__(path, &quot;hydra&quot;, &quot;-l&quot;, user, &quot;-P&quot;, wordlist, target, protocol, &quot;-t&quot;, &quot;4&quot;)
    
    # define rules for parsing the output
    @staticmethod
    def password_rule(output):
        lines = output.splitlines()
        i = 0
        for line in lines:
            if &quot;login:&quot; in line:
                line_to_select: str = lines[i + 1]
                return line_to_select.split(&quot; &quot;)[1]
            i += 1
    
    @staticmethod
    def username_rule(output):
        lines = output.splitlines()
        i = 0
        for line in lines:
            if &quot;login:&quot; in line:
                line_to_select: str = lines[i + 1]
                return line_to_select.split(&quot; &quot;)[0]
            i += 1

    @property
    def username(self):
        return self.username_result

    @property
    def password(self):
        return self.password_result

    def on_end(self):
        return super().on_end()
</code></pre>
                <h3 id="2-what-is-rule">2. what is rule?</h3>
                <p>rule is a function that takes the output of the command line tool and returns the result you want to get from the output</p>
                <h4 id="how-to-define-a-rule">how to define a rule?</h4>
                <ul>
                    <li>implicitly the implicit definition of a rule function must end with <code>_rule</code> and must be static</li>
                </ul>
                <pre><code class="language-python">@staticmethod
def password_rule(output):
    lines = output.splitlines()
    i = 0
    for line in lines:
        if &quot;login:&quot; in line:
            line_to_select: str = lines[i + 1]
            return line_to_select.split(&quot; &quot;)[1]
        i += 1
</code></pre>
                <ul>
                    <li>explicitly the explicit definition of a rule must override the <code>on_end</code> using self.rule_register(rule_name, rule_function)</li>
                </ul>
                <pre><code class="language-python">from cigaro.AbstractTool import ToolAbstract


class NmapLite(ToolAbstract):
    def __init__(self, tport: str, target: str):
        super().__init__(&quot;nmap&quot;, &quot;-p&quot;, tport, target)
        self.rule_register(&quot;state&quot;, self.state_rule_explicit)

    @staticmethod  # added in explicit rule definition
    def state_rule_explicit(out):
        lines = out.splitlines()
        i = 0
        for line in lines:
            if &quot;PORT&quot; in line:
                line_to_select: str = lines[i + 1]
                return line_to_select.split(&quot; &quot;)[1]
            i += 1

    # implicit rule definition
    @staticmethod
    def service_rule(out):
        lines = out.splitlines()
        i = 0
        for line in lines:
            if &quot;PORT&quot; in line:
                line_to_select: str = lines[i + 1]
                return line_to_select.split(&quot; &quot;)[2]
            i += 1

    @staticmethod
    def port_rule(out):
        lines = out.splitlines()
        i = 0
        for line in lines:
            if &quot;PORT&quot; in line:
                line_to_select: str = lines[i + 1]
                return line_to_select.split(&quot; &quot;)[0]
            i += 1
    @staticmethod
    def portr(out):
        pass
    @property
    def port_r(self):
        return self.port_result

    @property
    def state_r(self):
        return self.state_result

    @property
    def service_r(self):
        return self.service_result

    def on_end(self):
        self.rule_register(&quot;state&quot;, self.state_rule_explicit)
        return super().on_end()
</code></pre>
                <h3 id="how-to-get-the-result">how to get the result?</h3>
                <p>you should to define a property, this property should return the result of the rule the return variable should be named <code>rule_name</code> + <code>_result</code></p>
                <pre><code class="language-python">@property
def username(self):
    return self.username_result
</code></pre>
                <h3 id="3-how-to-use-the-tool-module">3. how to use the tool module?</h3>
                <pre><code class="language-python">from yourmodule import Hydra

hydra = Hydra(
    &quot;localhost&quot;,
    &quot;admin&quot;,
    &quot;wordlist.txt&quot;,
    &quot;ssh&quot;
)
hydra.start()
hydra.wait()

print(hydra.username)
print(hydra.password)
</code></pre>
                <h3 id="async-support">Async Support</h3>
                <p>example on webpalm tool
                    <a href="github.com/Malwarize/webpalm">webpalm</a></p>
                <pre><code class="language-python">import json
import shutil

from cigaro.AbstractTool import ToolAbstractAsync


class WebPalmAsync(ToolAbstractAsync):
    def __init__(self, target: str, level: int):
        name = &quot;webpalm&quot;
        path = shutil.which(&quot;webpalm&quot;, path=&quot;/home/xorbit/go/bin&quot;)
        super().__init__(name, path, &quot;-u&quot;, target, &quot;-l&quot;, str(level), &quot;-o&quot;, &quot;/tmp/web_palm_output.json&quot;)

    @staticmethod
    def urls_rule(_):
        with open(&quot;/tmp/web_palm_output.json&quot;, &quot;r&quot;) as f:
            urls = json.load(f)
        return urls

    @property
    def urls(self):
        return self.urls_result
</code></pre>
                <h3 id="4-how-to-use-the-tool-module-async">4. how to use the tool module async?</h3>
                <pre><code class="language-python">from yourmodule import WebPalmAsync
webpalm = WebPalmAsync(&quot;https://google.com&quot;, 1)
await webpalm.start()
await webpalm.wait()
print(webpalm.urls)
</code></pre>

            </div>
        </div>
    </div>

    <footer class=" text-black shadow bg-white dark:bg-graylight dark:text-white transition-all duration-[1500ms]">
        <div class="w-full max-w-screen-xl mx-auto p-4 md:py-8">
            <div class="sm:flex sm:items-center sm:justify-between">
                <a href="https://github.com/XORbit-01/" class="flex items-center mb-4 sm:mb-0 space-x-2">
                <svg version="1.1" id="_x32_" xmlns="http://www.w3.org/2000/svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" class="w-10">
                    <style type="text/css">
                        .st0 {
                            fill: #5a08dd;
                        }
                    </style>
                    <g>
                        <path class="st0" d="M251.777,408.739l3.352-79.744h125.915l1.672,79.744h67.162L459.953,288.7H512
                    c0-120.882-63.802-141.029-88.981-141.029H249.632C219.419,56.135,171.157-2.201,102.315,9.545
                    c-24.064,4.112-46.604,16.059-59.984,35.339l-35.71,2.602c-2.671,0.201-5.002,1.866-6.047,4.328
                    c-1.053,2.462-0.635,5.304,1.076,7.355l27.186,32.698c0.364,0.45,0.79,0.828,1.239,1.162c0.31,3.941,0.874,8.014,1.742,12.211
                    c1.75,8.587,17.623,78.064,17.623,78.064h54.146c0,0,2.501-54.131,2.965-58.297c0.836-7.549,6.125-12.798,10.91,0l68.834,283.731
                    H251.777z" />
                        <rect x="148.904" y="418.339" class="st0" width="331.14" height="30.213" />
                        <path class="st0" d="M218.157,456.11c-13.209,0-23.926,10.708-23.926,23.918c0,13.217,10.716,23.926,23.926,23.926
                    c13.209,0,23.926-10.709,23.926-23.926C242.083,466.818,231.366,456.11,218.157,456.11z" />
                        <path class="st0" d="M419.612,456.11c-13.209,0-23.918,10.708-23.918,23.918c0,13.217,10.708,23.926,23.918,23.926
                    c13.209,0,23.925-10.709,23.925-23.926C443.537,466.818,432.821,456.11,419.612,456.11z" />
                    </g>
                </svg> <span class="self-center text-2xl font-semibold whitespace-nowrap dark:text-white">
                    Malwarize
                </span>
            </a>
                <ul class="flex flex-wrap items-center mb-6 text-sm font-medium text-gray-500 sm:mb-0 dark:text-gray-400">
                    <li>
                        <a href="#" class="mr-4 btn md:mr-6 ">About</a>
                    </li>
                    <li>
                        <a href="#" class="mr-4 btn md:mr-6">Linked In</a>
                    </li>
                    <li>
                        <a href="#" class="mr-4 btn md:mr-6 ">Discord</a>
                    </li>
                    <li>
                        <a href="#" class="mr-4 btn md:mr-6">Contact</a>
                    </li>
                </ul>
            </div>
            <hr class="my-6 border-gray-200 sm:mx-auto dark:border-gray-700 lg:my-8" />
            <span class="block text-sm text-gray-500 sm:text-center dark:text-gray-400">¬© 2023 <a href="#"
                class="hover:underline">Malwarize website</a>. All Rights Reserved.</span>
        </div>
    </footer>
    <script src="static/js/modeswitcher.js"></script>
    <script src="static/js/scrollbutton.js"></script>



    <script src="static/js/scrollspy.js"></script>
    <script src="static/js/mardownmodeswitcher.js"></script>


</body>

</html>